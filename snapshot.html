<!DOCTYPE html><html lang="nl"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 32.1.2 Logius profile 20220405">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
    
    
<link rel="shortcut icon" type="image/x-icon" href="https://publicatie.centrumvoorstandaarden.nl/respec/style/logos/logius.ico">
    
<title>Digikoppeling Koppelvlakstandaard REST-API 1.0.0</title>
    
    
    
    
<link rel="stylesheet" type="text/css" href="./media/style.css">
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"ยง";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "DEF",
  "specType": "ST",
  "pubDomain": "dk",
  "shortName": "restapi",
  "publishDate": "2022-04-11",
  "publishVersion": "1.0.0",
  "addSectionLinks": true,
  "license": "cc-by-nd",
  "doJsonLd": true,
  "editors": [
    {
      "name": "Peter Haasnoot",
      "company": "Logius",
      "companyURL": "http://www.logius.nl/"
    },
    {
      "name": "Pieter Hering",
      "company": "Logius",
      "companyURL": "http://www.logius.nl/"
    }
  ],
  "github": "https://github.com/Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API",
  "alternateFormats": [
    {
      "label": "pdf",
      "uri": "Digikoppeling-Koppelvlakstandaard-REST-API.pdf"
    }
  ],
  "nl_addReleaseTagTitle": true,
  "nl_markdownSplitH1sections": true,
  "nl_organisationName": "Logius",
  "nl_organisationPrefix": "LS-",
  "nl_markdownEmbedImageInFigure": true,
  "nl_organisationStylesURL": "https://publicatie.centrumvoorstandaarden.nl/respec/style/",
  "nl_organisationPublishURL": "https://publicatie.centrumvoorstandaarden.nl/",
  "nl_logo": {
    "src": "https://publicatie.centrumvoorstandaarden.nl/respec/style/logos/figure-logius.svg",
    "alt": "Logius",
    "id": "Logius",
    "height": 77,
    "width": 44,
    "url": "https://www.logius.nl/standaarden"
  },
  "localBiblio": {
    "NEN3610": {
      "href": "http://www.nen.nl/web/Normshop/Norm/NEN-36102011-nl.htm",
      "title": "Basismodel Geo-informatie - Termen, definities, relaties en algemene regels voor de uitwisseling van informatie over aan de aarde gerelateerde ruimtelijke objecten",
      "authors": [
        ""
      ],
      "date": "Maart 2011",
      "publisher": "Nederlands Normalisatie-instituut"
    },
    "ADR": {
      "href": "https://publicatie.centrumvoorstandaarden.nl/api/adr/",
      "title": "API Design Rules (Nederlandse API Strategie IIa)",
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "date": "Juli 2020",
      "publisher": "Logius",
      "id": "adr"
    },
    "ADR-ext": {
      "href": "https://docs.geostandaarden.nl/api/API-Strategie-ext",
      "title": "API Designrules Extensions (Nederlandse API Strategie IIb)",
      "authors": [
        "Jasper Roes",
        "Linda van den Brink"
      ],
      "date": "Januari 2020",
      "publisher": "Geonovum/Kennisplatform APi's",
      "id": "adr-ext"
    },
    "Beheermodel": {
      "href": "https://www.logius.nl/sites/default/files/public/bestanden/diensten/DigiKoppeling/Standaarden/Digikoppeling-Beheermodel.pdf",
      "title": "Beheermodel en releasebeleid Digikoppeling v1.5",
      "date": "Oktober 2017",
      "publisher": "Logius"
    },
    "Digikoppeling-Architectuur": {
      "href": "https://centrumvoorstandaarden.github.io/Architectuur2.0-metRestfulAPI/static.html",
      "title": "Digikoppeling Architectuur",
      "authors": [
        "Logius Centrum voor standaarden"
      ],
      "date": "december 2020",
      "publisher": "Logius"
    },
    "Digikoppeling-Beveiligingsdocument": {
      "href": "https://publicatie.centrumvoorstandaarden.nl/dk/beveilig/1.3/",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften",
      "date": "2020",
      "publisher": "Logius",
      "id": "digikoppeling-beveiligingsdocument"
    },
    "Digikoppeling-Identificatie-Authenticatie": {
      "href": "http://www.logius.nl/digikoppeling",
      "title": "Digikoppeling Identificatie en Authenticatie",
      "publisher": "Logius",
      "id": "digikoppeling-identificatie-authenticatie"
    },
    "Digikoppeling-Cert": {
      "href": "http://www.logius.nl/digikoppeling",
      "title": "Gebruik en achtergrond van Digikoppeling certificaten",
      "publisher": "Logius"
    },
    "PKI-Policy": {
      "href": "https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/pogramma-van-eisen",
      "title": "Programma van Eisen (PKIoverheid)",
      "publisher": "Logius",
      "id": "pki-policy"
    },
    "PKI-CA": {
      "href": "https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/toegetreden-vertrouwensdienstverleners",
      "title": "Toegetreden vertrouwensdienstverleners",
      "publisher": "Logius"
    },
    "PKIoverheid-Certificaten": {
      "href": "https://cert.pkioverheid.nl/",
      "title": "Pkioverheid certificaten",
      "publisher": "Logius"
    },
    "Logius-website": {
      "href": "https://logius.nl/digikoppeling",
      "title": "Logius Digikoppeling",
      "publisher": "Logius"
    },
    "Digikoppeling-Compliance-Voorziening": {
      "href": "https://portaal.digikoppeling.nl",
      "title": "Digikoppeling Compliance Voorziening",
      "publisher": "Logius"
    }
  },
  "publishISODate": "2022-04-11T00:00:00.000Z",
  "generatedSubtitle": "Vastgestelde versie 11 april 2022"
}</script>
<link rel="stylesheet" href="https://publicatie.centrumvoorstandaarden.nl/respec/style/LS-DEF.css"></head>
  <body class="h-entry toc-inline"><div class="head">
    <a class="logo" href="https://www.logius.nl/standaarden"><img alt="Logius" height="77" id="Logius" src="https://publicatie.centrumvoorstandaarden.nl/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">Digikoppeling Koppelvlakstandaard REST-API 1.0.0</h1>
    
    <h2>
      Logius Standaard<br>
      Vastgestelde versie
      <time class="dt-published" datetime="2022-04-11">11 april 2022</time>
    </h2>
    <dl>
      <dt>Deze versie:</dt><dd class="status">
              <a class="u-url status" href="https://publicatie.centrumvoorstandaarden.nl/dk/restapi/1.0.0">https://publicatie.centrumvoorstandaarden.nl/dk/restapi/1.0.0</a>
            </dd><dt>Laatst gepubliceerde versie:</dt><dd>
              <a href="https://publicatie.centrumvoorstandaarden.nl/dk/restapi/">https://publicatie.centrumvoorstandaarden.nl/dk/restapi/</a>
            </dd>
      <dt>Laatste werkversie:</dt><dd><a href="https://logius-standaarden.github.io/Digikoppeling-Koppelvlakstandaard-REST-API/">https://logius-standaarden.github.io/Digikoppeling-Koppelvlakstandaard-REST-API/</a></dd>
      
      
      
      
      
      <dt>Redacteurs:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Peter Haasnoot</span> (<a class="p-org org h-org" href="http://www.logius.nl/">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Pieter Hering</span> (<a class="p-org org h-org" href="http://www.logius.nl/">Logius</a>)
  </dd>
      
      
      <dt>Doe mee:</dt><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API/">GitHub Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API/issues/">Dien een melding in</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API/commits/">Revisiehistorie</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Koppelvlakstandaard-REST-API/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    <p lang="en">
          This document is also available in this non-normative format:
          <a rel="alternate" href="Digikoppeling-Koppelvlakstandaard-REST-API.pdf">pdf</a>
        </p>
    <p class="copyright" lang="en">
          This document is licensed under a
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/" class="subfoot">Creative Commons Attribution 4.0 License</a>.
        </p>
    <hr title="Separator for header">
  </div>
    
    <section id="sotd" class="introductory"><h2>Status van dit document</h2>Dit is de definitieve versie van de  standaard. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.<p>Het OBDO heeft op advies van het Forum Standaardisatie deze versie vastgesteld.</p></section><nav id="toc"><h2 class="introductory" id="inhoudsopgave">Inhoudsopgave</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#sotd">Status van dit document</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1. </bdi>Conformiteit</a></li><li class="tocline"><a class="tocxref" href="#context-voor-ontwikkeling-van-het-digikoppeling-rest-api-profiel"><bdi class="secno">2. </bdi>Context voor ontwikkeling van het Digikoppeling REST API profiel</a></li><li class="tocline"><a class="tocxref" href="#toelichting-bij-de-scope-van-het-digikoppeling-rest-api-profiel"><bdi class="secno">3. </bdi>Toelichting bij de scope van het Digikoppeling REST API profiel</a></li><li class="tocline"><a class="tocxref" href="#digikoppeling-restful-api-profiel"><bdi class="secno">4. </bdi>Digikoppeling Restful API profiel</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#inleiding"><bdi class="secno">4.1 </bdi>Inleiding</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#historie"><bdi class="secno">4.1.1 </bdi>Historie</a></li><li class="tocline"><a class="tocxref" href="#toepassingsgebied"><bdi class="secno">4.1.2 </bdi>Toepassingsgebied</a></li></ol></li><li class="tocline"><a class="tocxref" href="#digikoppeling-rest-api-profiel"><bdi class="secno">4.2 </bdi>Digikoppeling REST-API profiel</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#algemeen"><bdi class="secno">4.2.1 </bdi>Algemeen</a></li><li class="tocline"><a class="tocxref" href="#koppelvlak-generiek"><bdi class="secno">4.2.2 </bdi>Koppelvlak Generiek</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#vertrouwelijkheid"><bdi class="secno">4.2.2.1 </bdi>Vertrouwelijkheid</a></li><li class="tocline"><a class="tocxref" href="#identificatie-authenticatie"><bdi class="secno">4.2.2.2 </bdi>Identificatie &amp; Authenticatie</a></li></ol></li><li class="tocline"><a class="tocxref" href="#api-design-rules"><bdi class="secno">4.2.3 </bdi>API Design Rules</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#toelichting-aanduidingen"><bdi class="secno">4.2.3.1 </bdi>Toelichting aanduidingen</a></li><li class="tocline"><a class="tocxref" href="#regels"><bdi class="secno">4.2.3.2 </bdi>Regels</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#afspraken-api-design-rules-extensies"><bdi class="secno">4.3 </bdi>Afspraken API Design Rules extensies</a></li></ol></li><li class="tocline"><a class="tocxref" href="#bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api"><bdi class="secno">5. </bdi>BIJLAGE Gebruik van Signing &amp; Encryptie in de context van HTTP / Rest API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#signing-in-de-context-van-http-rest"><bdi class="secno">5.1 </bdi>Signing in de context van HTTP Rest</a></li><li class="tocline"><a class="tocxref" href="#encryptie-in-de-context-van-http-rest"><bdi class="secno">5.2 </bdi>Encryptie in de context van HTTP Rest</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>Referenties</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normatieve-referenties"><bdi class="secno">A.1 </bdi>Normatieve referenties</a></li><li class="tocline"><a class="tocxref" href="#informatieve-referenties"><bdi class="secno">A.2 </bdi>Informatieve referenties</a></li></ol></li></ol></nav>
   <section id="conformance"><div class="header-wrapper"><h2 id="x1-conformiteit"><bdi class="secno">1. </bdi>Conformiteit</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 1."></a></div><p>Naast onderdelen die als niet normatief gemarkeerd zijn, zijn ook alle diagrammen, voorbeelden, en noten in dit document niet normatief. Verder is alles in dit document normatief.</p>
     
   </section>   
	<section id="context-voor-ontwikkeling-van-het-digikoppeling-rest-api-profiel"><div class="header-wrapper"><h2 id="x2-context-voor-ontwikkeling-van-het-digikoppeling-rest-api-profiel"><bdi class="secno">2. </bdi>Context voor ontwikkeling van het Digikoppeling REST API profiel</h2><a class="self-link" href="#context-voor-ontwikkeling-van-het-digikoppeling-rest-api-profiel" aria-label="Permalink for Section 2."></a></div>
<p>Het Digikoppeling Rest API profiel is gericht op Machine-to-Machine (M2M) en Government-to-Government (G2G) interacties conform de algemene uitgangspunten van de Digikoppeling standaard en het toepassingsgebied van Digikoppeling op de Pas-toe-of-leg-uit lijst (PTLU) van het Forum Standaardisatie;</p>
<p>Opzet Digikoppeling:</p>
<p><figure id="fig-overzicht-digikoppeling-koppelvlakken"><img src="media/fig-structuurv2.png" alt="Overzicht Digikoppeling Koppelvlakken" title="Overzicht Digikoppeling Koppelvlakken"><figcaption>Figuur <bdi class="figno">1</bdi> <span class="fig-title">Overzicht Digikoppeling Koppelvlakken</span></figcaption></figure></p>
</section>
	<section id="toelichting-bij-de-scope-van-het-digikoppeling-rest-api-profiel"><div class="header-wrapper"><h2 id="x3-toelichting-bij-de-scope-van-het-digikoppeling-rest-api-profiel"><bdi class="secno">3. </bdi>Toelichting bij de scope van het Digikoppeling REST API profiel</h2><a class="self-link" href="#toelichting-bij-de-scope-van-het-digikoppeling-rest-api-profiel" aria-label="Permalink for Section 3."></a></div>
<p><figure id="fig-digikoppeling-voor-closed-data-g2g-uitwisseling"><img src="media/DK_closed_g2g.svg" alt="Digikoppeling voor Closed Data G2G Uitwisseling" title="Digikoppeling voor Closed Data G2G Uitwisseling"><figcaption>Figuur <bdi class="figno">2</bdi> <span class="fig-title">Digikoppeling voor Closed Data G2G Uitwisseling</span></figcaption></figure></p>


<p>In de figuur wordt onderscheid gemaakt tussen open en gesloten diensten:</p>
<ul>
<li>Open Diensten: Diensten zonder toegangsbeperking bv open data.</li>
<li>Gesloten Diensten: Diensten met toegangsbeperking bv persoonsgegevens en vertrouwelijke gegevens of diensten voor specifieke partijen.</li>
</ul>
<p>Het Digikoppeling REST API profiel richt zich op Machine-to-Machine (M2M) gegevensuitwisseling via een gesloten dienst tussen overheidspartijen.
Buiten scope van het profiel zijn:</p>
<ul>
<li>REST API's voor open diensten van een overheidspartij.</li>
<li>REST API's voor gesloten diensten van een overheidspartij (direct) aan burgers of bedrijven.</li>
</ul>
<p>Het Digikoppeling REST API profiel is wat betreft functionele toepassing vergelijkbaar met het Digikoppeling WUS profiel.
De client van de dienstafnemer die gebruik maakt van het Digikoppeling REST API profiel is in deze context een systeem (applicatie) en geen internetbrowser.</p>
<table class="simple">
<thead>
<tr>
<th>Invulling Digikoppeling</th>
<th>DK REST API profiel</th>
<th>DK WUS profiel</th>
<th>DK ebMS2 profiel</th>
</tr>
</thead>
<tbody><tr>
<td>Bevragingen / Meldingen</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>best-effort</td>
<td>1.0</td>
<td>2W-be</td>
<td>osb-be</td>
</tr>
<tr>
<td>best-effort signed</td>
<td></td>
<td>2W-be-S</td>
<td>osb-be-s</td>
</tr>
<tr>
<td>best-effort signed/encrypted</td>
<td></td>
<td>2W-be-SE</td>
<td>osb-be-e</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>reliable</td>
<td></td>
<td></td>
<td>osb-rm</td>
</tr>
<tr>
<td>reliable signed</td>
<td></td>
<td></td>
<td>osb-rm-s</td>
</tr>
<tr>
<td>reliable signed en encrypted</td>
<td></td>
<td></td>
<td>osb-rm-e</td>
</tr>
</tbody></table>
<p>In versie 1.0 van het Digikoppeling REST API profiel wordt signing en encryptie niet ondersteund. In toekomstige versies van het profiel zal hier wel invulling aan worden gegeven. (Zie ook <a href="#bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api" data-matched-text="[[[#bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api]]]" class="sec-ref"><bdi class="secno">5. </bdi>BIJLAGE Gebruik van Signing &amp; Encryptie in de context van HTTP / Rest API</a>)</p>
</section>
	<section id="digikoppeling-restful-api-profiel"><div class="header-wrapper"><h2 id="x4-digikoppeling-restful-api-profiel"><bdi class="secno">4. </bdi>Digikoppeling Restful API profiel</h2><a class="self-link" href="#digikoppeling-restful-api-profiel" aria-label="Permalink for Section 4."></a></div>
<section id="inleiding"><div class="header-wrapper"><h3 id="x4-1-inleiding"><bdi class="secno">4.1 </bdi>Inleiding</h3><a class="self-link" href="#inleiding" aria-label="Permalink for Section 4.1"></a></div>
<section id="historie"><div class="header-wrapper"><h4 id="x4-1-1-historie"><bdi class="secno">4.1.1 </bdi>Historie</h4><a class="self-link" href="#historie" aria-label="Permalink for Section 4.1.1"></a></div>
<p>Vanuit het TO Digikoppeling zijn al langere tijd de ontwikkelingen rond Restful API's gevolgd. Binnen het Kennisplatform API zijn de REST-API Design Rules (REST ADR) ontwikkeld en de REST ADR standaard is ook opgenomen op de Pas-toe-of-leg-uit lijst van het Forum Standaardisatie. De REST ADR standaard is dan ook als basis genomen voor dit Digikoppeling REST API Profiel dat zich specifiek richt op G2G (Government-to-Government) interactie en M2M (Machine-to-Machine verkeer).</p>
</section><section id="toepassingsgebied"><div class="header-wrapper"><h4 id="x4-1-2-toepassingsgebied"><bdi class="secno">4.1.2 </bdi>Toepassingsgebied</h4><a class="self-link" href="#toepassingsgebied" aria-label="Permalink for Section 4.1.2"></a></div>
<p>Het toepassingsgebied is voor Digikoppeling:</p>
<blockquote>
<p><em>Digikoppeling moet worden toegepast op alle digitale gegevensuitwisseling met behulp van gestructureerde berichten die plaatsvindt met voorzieningen die onderdeel zijn van de GDI, waaronder de basisregistraties, of die sector-overstijgend is.</em></p>
</blockquote>
<p>Dit profiel is toe te passen bij het aanbieden van REST API's ten behoeve van het ontsluiten van overheidsinformatie en/of functionaliteit.</p>
</section></section><section id="digikoppeling-rest-api-profiel"><div class="header-wrapper"><h3 id="x4-2-digikoppeling-rest-api-profiel"><bdi class="secno">4.2 </bdi>Digikoppeling REST-API profiel</h3><a class="self-link" href="#digikoppeling-rest-api-profiel" aria-label="Permalink for Section 4.2"></a></div>
<section id="algemeen"><div class="header-wrapper"><h4 id="x4-2-1-algemeen"><bdi class="secno">4.2.1 </bdi>Algemeen</h4><a class="self-link" href="#algemeen" aria-label="Permalink for Section 4.2.1"></a></div>
<p>Het Digikoppeling REST-API profiel is gebaseerd op de REST-API Design Rules standaard zoals ontwikkeld door het Kennisplatform API's en in beheer gebracht bij Logius Stelsels &amp; Standaarden: [<cite><a class="bibref" data-link-type="biblio" href="#bib-adr" title="API Design Rules (Nederlandse API Strategie IIa)">ADR</a></cite>]</p>
<p>Het Digikoppeling REST-API profiel conformeert zich volledig aan het normatieve deel van de REST-API Design Rules.</p>
</section><section id="koppelvlak-generiek"><div class="header-wrapper"><h4 id="x4-2-2-koppelvlak-generiek"><bdi class="secno">4.2.2 </bdi>Koppelvlak Generiek</h4><a class="self-link" href="#koppelvlak-generiek" aria-label="Permalink for Section 4.2.2"></a></div>
<section id="vertrouwelijkheid"><div class="header-wrapper"><h5 id="x4-2-2-1-vertrouwelijkheid"><bdi class="secno">4.2.2.1 </bdi>Vertrouwelijkheid</h5><a class="self-link" href="#vertrouwelijkheid" aria-label="Permalink for Section 4.2.2.1"></a></div>
<p>De Digikoppeling Beveiligingsstandaarden en voorschriften gaan specifiek in op het verplichte gebruik van PKIO certificaten [<cite><a class="bibref" data-link-type="biblio" href="#bib-pki-policy" title="Programma van Eisen (PKIoverheid)">PKI-Policy</a></cite>] en 2-zijdig TLS.</p>
<ul>
<li>Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-digikoppeling-beveiligingsdocument" title="Digikoppeling Beveiligingsstandaarden en voorschriften">Digikoppeling-Beveiligingsdocument</a></cite>]</li>
</ul>
</section><section id="identificatie-authenticatie"><div class="header-wrapper"><h5 id="x4-2-2-2-identificatie-authenticatie"><bdi class="secno">4.2.2.2 </bdi>Identificatie &amp; Authenticatie</h5><a class="self-link" href="#identificatie-authenticatie" aria-label="Permalink for Section 4.2.2.2"></a></div>
<p>Digikoppeling maakt gebruik van het OIN (Organisatie Identificatie Nummer) voor de identificatie van organisaties.
Binnen dit DK REST-API profielprofiel zijn er alleen voorschriften m.b.t. het verplicht gebruik van het OIN binnen PKIO certificaten. Voor OIN gebruik binnen payloads (bv JSON) of resource-pad gelden geen specifieke voorschriften.</p>
<ul>
<li>Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-digikoppeling-identificatie-authenticatie" title="Digikoppeling Identificatie en Authenticatie">Digikoppeling-Identificatie-Authenticatie</a></cite>]</li>
</ul>
</section></section><section id="api-design-rules"><div class="header-wrapper"><h4 id="x4-2-3-api-design-rules"><bdi class="secno">4.2.3 </bdi>API Design Rules</h4><a class="self-link" href="#api-design-rules" aria-label="Permalink for Section 4.2.3"></a></div>
<section id="toelichting-aanduidingen"><div class="header-wrapper"><h5 id="x4-2-3-1-toelichting-aanduidingen"><bdi class="secno">4.2.3.1 </bdi>Toelichting aanduidingen</h5><a class="self-link" href="#toelichting-aanduidingen" aria-label="Permalink for Section 4.2.3.1"></a></div>
<p> Voorschriften zijn aangeduid met 'Verplicht', 'Aanbevolen' en 'Niet van Toepassing' waarvoor de volgende definities gelden:</p>
<table class="simple">
<thead>
<tr>
<th>Categorie</th>
<th>Codering RFC2119</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>Verplicht</td>
<td>MUST</td>
<td>De eisen moeten gevolgd worden. Hier kan niet van afgeweken worden.</td>
<td></td>
</tr>
<tr>
<td>Aanbevolen</td>
<td>SHOULD</td>
<td>Aanbevolen is om de eisen conform conform voorschrift te implementeren. Wanneer hier van afgeweken wordt dient een zorgvuldige afweging plaats te vinden</td>
<td></td>
</tr>
<tr>
<td>Niet van Toepassing</td>
<td>-</td>
<td>De eisen zijn niet van toepassing</td>
<td></td>
</tr>
</tbody></table>
<p>(Indeling gebaseerd op [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">rfc2119</a></cite>])</p>
</section><section id="regels"><div class="header-wrapper"><h5 id="x4-2-3-2-regels"><bdi class="secno">4.2.3.2 </bdi>Regels</h5><a class="self-link" href="#regels" aria-label="Permalink for Section 4.2.3.2"></a></div>
<p>Het Digikoppeling REST-API profiel conformeert zich volledig aan het normatieve deel van de [<cite><a class="bibref" data-link-type="biblio" href="#bib-adr" title="API Design Rules (Nederlandse API Strategie IIa)">ADR</a></cite>].</p>
<table class="simple">
<thead>
<tr>
<th>Categorie</th>
<th>Principe</th>
<th>Toelichting</th>
<th>Link</th>
</tr>
</thead>
<tbody><tr>
<td>Verplicht</td>
<td>REST-API Design Rules</td>
<td>Het is verplicht te voldoen aan alle (normatieve) eisen van de REST-API Design Rules</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-adr" title="API Design Rules (Nederlandse API Strategie IIa)">ADR</a></cite>].</td>
</tr>
</tbody></table>
<p>In onderstaande tabel worden de normatieve eisen van de [<cite><a class="bibref" data-link-type="biblio" href="#bib-adr" title="API Design Rules (Nederlandse API Strategie IIa)">ADR</a></cite>] weergegeven:</p>
<p>Normatieve eisen van de REST API Design Rules</p>
<table class="simple">
<thead>
<tr>
<th>Categorie</th>
<th>Principe</th>
<th>Toelichting</th>
<th>Link</th>
</tr>
</thead>
<tbody><tr>
<td>Verplicht</td>
<td>3.1 API-01: Adhere to HTTP safety and idempotency semantics for operations</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-01">API-01: Adhere to HTTP safety and idempotency semantics for operations</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.3 API-02: Do not maintain state information at the server</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-02">API-02: Do not maintain session state on the server</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.2 API-03: Only apply default HTTP operations</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-03">API-03: Only apply standard HTTP methods</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.1 API-04: Define interfaces in Dutch unless there is an official English glossary available</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-04">API-04: Define interfaces in Dutch unless there is an official English glossary available</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.5 API-05: Use nouns to indicate resources</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-05">API-05: Use nouns to name resources</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.4 API-06: Use nested resources for child resources</td>
<td></td>
<td><a href="hhttps://publicatie.centrumvoorstandaarden.nl/api/adr/#api-06">API-06: Use nested URIs for child resources</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.5 API-10: Model resource operations as a sub-reresource or dedicated resource</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-10">API-10: Model resource operations as a sub-resource or dedicated resource</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.6 API-16: Use OpenAPI Specification for documentation</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-16">API-16: Use OpenAPI Specification for documentation</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.6 API-17: Publish documentation in Dutch unless there is existing documentation in English</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-17">API-17: Publish documentation in Dutch unless there is existing documentation in English</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-18: Include a deprecation schedule when publishing API changes</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-18">API-18: Include a deprecation schedule when publishing API changes</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-19: Schedule a fixed transition period for a new major API version</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-19">API-19: Schedule a fixed transition period for a new major API version</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-20: Include the major version number in the URI</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-20">API-20: Include the major version number in the URI</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.1 API-48: Leave off trailing slashes from URIs</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-48">API-48: Leave off trailing slashes from URIs</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.6 API-51: Publish OAS at a standard location in JSON-format</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-51">API-51: Publish OAS document at a standard location in JSON-format</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.1 API-53: Hide irrelevant implementation details</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-53">API-53: Hide irrelevant implementation details</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.1 API-54: Use plural nouns to name collection resources</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-54">API-54: Use plural nouns to name collection resources</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-55: Publish a changelog for API changes between versions</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-55">API-55: Publish a changelog for API changes between versions</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-56: Adhere to the Semantic Versioning model when releasing API changes</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-56">API-56: Adhere to the Semantic Versioning model when releasing API changes</a></td>
</tr>
<tr>
<td>Verplicht</td>
<td>3.7 API-57: Return the full version number in a response header</td>
<td></td>
<td><a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/#api-57">API-57: Return the full version number in a response header</a></td>
</tr>
</tbody></table>
</section></section></section><section id="afspraken-api-design-rules-extensies"><div class="header-wrapper"><h3 id="x4-3-afspraken-api-design-rules-extensies"><bdi class="secno">4.3 </bdi>Afspraken API Design Rules extensies</h3><a class="self-link" href="#afspraken-api-design-rules-extensies" aria-label="Permalink for Section 4.3"></a></div>
<p>De ADR extensie onderderdelen van dit profiel zijn gebaseerd op: [<cite><a class="bibref" data-link-type="biblio" href="#bib-adr-ext" title="API Designrules Extensions (Nederlandse API Strategie IIb)">ADR-ext</a></cite>].</p>
<p>Hieronder wordt aangegeven welke regels uit de API Design Rules extensies in dit profiel verplicht zijn of worden aanbevolen.</p>
<table class="simple">
<thead>
<tr>
<th>Categorie</th>
<th>Principe</th>
<th>Extensie</th>
<th>Toelichting</th>
<th>Link</th>
</tr>
</thead>
<tbody><tr>
<td>Niet van toepassing</td>
<td>17.1 API-11: Encrypt connections using at least TLS v1.3</td>
<td>Security</td>
<td>Vervangen door Digikoppeling beveiligingsvoorschriften (*)</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-digikoppeling-beveiligingsdocument" title="Digikoppeling Beveiligingsstandaarden en voorschriften">Digikoppeling-Beveiligingsdocument</a></cite>]</td>
</tr>
<tr>
<td>Verplicht</td>
<td>17.3 API-13: Accept tokens as HTTP headers only</td>
<td>Security Authorisation</td>
<td></td>
<td><a href="https://docs.geostandaarden.nl/api/def-hr-API-Strategie-ext-20211013/#api-13">17.3 API-13: Accept tokens as HTTP headers only</a></td>
</tr>
<tr>
<td>Aanbevolen</td>
<td>17.31 API-46: Use default error handling</td>
<td>Error handling</td>
<td></td>
<td><a href="https://docs.geostandaarden.nl/api/def-hr-API-Strategie-ext-20211013#api-46">17.31 API-46: Use default error handling</a></td>
</tr>
<tr>
<td>Aanbevolen</td>
<td>17.32 API-47: Use the required HTTP status codes</td>
<td>Error handling</td>
<td></td>
<td><a href="https://docs.geostandaarden.nl/api/def-hr-API-Strategie-ext-20211013#api-47">17.32 API-47: Use the required HTTP status codes</a></td>
</tr>
</tbody></table>


<p>(*) Wat betreft TLS zijn de Digikoppeling beveiligingsvoorschriften leidend , Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-digikoppeling-beveiligingsdocument" title="Digikoppeling Beveiligingsstandaarden en voorschriften">Digikoppeling-Beveiligingsdocument</a></cite>]</p>
</section></section>
	<section id="bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api"><div class="header-wrapper"><h2 id="x5-bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api"><bdi class="secno">5. </bdi>BIJLAGE Gebruik van Signing &amp; Encryptie in de context van HTTP / Rest API</h2><a class="self-link" href="#bijlage-gebruik-van-signing-encryptie-in-de-context-van-http-rest-api" aria-label="Permalink for Section 5."></a></div>
<aside class="note">Deze bijlage is informatief en geen normatief onderdeel van het profiel</aside>

<section id="signing-in-de-context-van-http-rest"><div class="header-wrapper"><h3 id="x5-1-signing-in-de-context-van-http-rest"><bdi class="secno">5.1 </bdi>Signing in de context van HTTP Rest</h3><a class="self-link" href="#signing-in-de-context-van-http-rest" aria-label="Permalink for Section 5.1"></a></div>
<p>Signing van HTTP body en/of header kan gebruikt worden voor <em>authenticatie</em>, om de <em>integriteit</em> van de request/response berichten te controleren en signing realiseert ook <em>onweerlegbaarheid</em>.
(Onweerlegbaarheid in de zin van: de verzender van de request/response kan niet ontkennen het bericht verzonden te hebben wanneer deze voorzien is van de digitale handtekening van de afzender).</p>
<p>De berichten kunnen ook samen met de digitale handtekeningen worden bewaard zodat deze bij audits of juridische bewijsvoering gebruikt kunnen worden.</p>
<p>Een HTTP requestbericht is opgebouwd uit de volgende onderdelen:</p>
<ul>
<li>Header<ul>
<li>HTTP operatie (GET, POST etc)</li>
<li>Pad / URL resource</li>
<li>Protocol</li>
<li>Header velden</li>
</ul>
</li>
<li>Body<ul>
<li><em>data</em></li>
</ul>
</li>
</ul>
<p>Door naast de body data ook onderdelen uit de header digitaal te ondertekenen kan worden gecontroleerd dat bv ook de HTTP operatie en resource specificatie in de request echt van de afzender afkomstig zijn en niet onderweg gemanipuleerd.</p>
<p>Enkele voorbeelden van signing standaarden die in ontwikkeling zijn:</p>
<ul>
<li><a href="https://tools.ietf.org/html/draft-ietf-httpbis-message-signatures">https://tools.ietf.org/html/draft-ietf-httpbis-message-signatures</a></li>
<li><a href="https://www.openbankingeurope.eu/media/2095/obe-json-web-signature-profile-for-open-banking.pdf">https://www.openbankingeurope.eu/media/2095/obe-json-web-signature-profile-for-open-banking.pdf</a></li>
</ul>
</section><section id="encryptie-in-de-context-van-http-rest"><div class="header-wrapper"><h3 id="x5-2-encryptie-in-de-context-van-http-rest"><bdi class="secno">5.2 </bdi>Encryptie in de context van HTTP Rest</h3><a class="self-link" href="#encryptie-in-de-context-van-http-rest" aria-label="Permalink for Section 5.2"></a></div>
<p>Voor encryptie is de standaard JSON Web Encryption (JWE) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7516" title="JSON Web Encryption (JWE)">rfc7516</a></cite>] beschikbaar</p>
<p>Zie ook de ADR extensie signing en encryptie:</p>
<ul>
<li><a href="https://docs.geostandaarden.nl/api/API-Strategie-ext/#signing-and-encryption">https://docs.geostandaarden.nl/api/API-Strategie-ext/#signing-and-encryption</a></li>
</ul>
</section></section>  
  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-referenties"><bdi class="secno">A. </bdi>Referenties</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normatieve-referenties">
    <div class="header-wrapper"><h3 id="a-1-normatieve-referenties"><bdi class="secno">A.1 </bdi>Normatieve referenties</h3><a class="self-link" href="#normatieve-referenties" aria-label="Permalink for Appendix A.1"></a></div>
    <dl class="bibliography"><dt id="bib-adr">[ADR]</dt><dd>
      <a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/"><cite>API Design Rules (Nederlandse API Strategie IIa)</cite></a>. Jasper Roes; Joost Farla.  Logius. Juli 2020. URL: <a href="https://publicatie.centrumvoorstandaarden.nl/api/adr/">https://publicatie.centrumvoorstandaarden.nl/api/adr/</a>
    </dd><dt id="bib-adr-ext">[ADR-ext]</dt><dd>
      <a href="https://docs.geostandaarden.nl/api/API-Strategie-ext"><cite>API Designrules Extensions (Nederlandse API Strategie IIb)</cite></a>. Jasper Roes; Linda van den Brink.  Geonovum/Kennisplatform APi's. Januari 2020. URL: <a href="https://docs.geostandaarden.nl/api/API-Strategie-ext">https://docs.geostandaarden.nl/api/API-Strategie-ext</a>
    </dd><dt id="bib-digikoppeling-beveiligingsdocument">[Digikoppeling-Beveiligingsdocument]</dt><dd>
      <a href="https://publicatie.centrumvoorstandaarden.nl/dk/beveilig/1.3/"><cite>Digikoppeling Beveiligingsstandaarden en voorschriften</cite></a>.  Logius. 2020. URL: <a href="https://publicatie.centrumvoorstandaarden.nl/dk/beveilig/1.3/">https://publicatie.centrumvoorstandaarden.nl/dk/beveilig/1.3/</a>
    </dd><dt id="bib-digikoppeling-identificatie-authenticatie">[Digikoppeling-Identificatie-Authenticatie]</dt><dd>
      <a href="http://www.logius.nl/digikoppeling"><cite>Digikoppeling Identificatie en Authenticatie</cite></a>.  Logius. URL: <a href="http://www.logius.nl/digikoppeling">http://www.logius.nl/digikoppeling</a>
    </dd><dt id="bib-pki-policy">[PKI-Policy]</dt><dd>
      <a href="https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/pogramma-van-eisen"><cite>Programma van Eisen (PKIoverheid)</cite></a>.  Logius. URL: <a href="https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/pogramma-van-eisen">https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/pogramma-van-eisen</a>
    </dd><dt id="bib-rfc7516">[rfc7516]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7516"><cite>JSON Web Encryption (JWE)</cite></a>. M. Jones; J. Hildebrand.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>
    </dd></dl>
  </section><section id="informatieve-referenties">
    <div class="header-wrapper"><h3 id="a-2-informatieve-referenties"><bdi class="secno">A.2 </bdi>Informatieve referenties</h3><a class="self-link" href="#informatieve-referenties" aria-label="Permalink for Appendix A.2"></a></div>
    <dl class="bibliography"><dt id="bib-rfc2119">[rfc2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">โ</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>